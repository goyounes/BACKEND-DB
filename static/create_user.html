<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Create movie</title>
  <link rel="stylesheet" href="/styles.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-width: 500px; /* Set the minimum width for the body */
      height: 100vh; /* Full viewport height */
    }
    h1{
      text-align: center
    }
    fieldset {
       /* padding: 15px; */
      margin-bottom: 10px;  /* Add margin between fieldsets*/ 
    }
    input {
      width: 100%; /* Make input fields take full width */
      padding: 8px;
      box-sizing: border-box; /* Ensure padding is included in width */
    }
    select {
      width: auto; /* Let the select box size to its content */
      padding: 8px;
      box-sizing: border-box; /* Ensure padding is included in width */
    }
    .container {
      width: 100%;
      max-width: 500px; /* Max width for both h1 and form */
    }
    
  </style>
</head>
<body>
  <div class="container">
  <h1>Add new user</h1>

  <form id= "NewUserForm" action="" method="">
      <fieldset>
      <legend>User Credentials</legend>

      <label for="user_email">Email:</label><br>
      <input type="email" id="user_email" name="user_email" placeholder="example@mail.com" required><br><br>

      <label for="password">Password:</label><br>
      <input type="password" id="user_password" name="user_password" required><br><br>

      <label for="user_name">Username:</label><br>
      <input type="text" id="user_name" name="user_name" required><br><br>

      </fieldset>
      <fieldset>
      <legend>User Information</legend>
      <label for="first_name">First Name:</label><br>
      <input type="text" id="first_name" name="first_name" required><br><br>

      <label for="last_name">Last Name:</label><br>
      <input type="text" id="last_name" name="last_name" required><br><br>

      <label for="role_id">Role:</label><br>
      <select id="role_id" name="role_id" required>
          <option value="1">User</option>
          <option value="2">Employee</option>
          <option value="3">Admin</option>
      </select><br><br>
    </fieldset>

    <br>
    <input type="submit" value="Create User">
  </form>
  
  <footer>
      <h4>Our Cinemas</h4>
      <div class="footer-grid">
        <div><strong>Nantes</strong><br>12 Rue de la Loire, 44000 Nantes<br>ðŸ“ž +33 2 40 12 34 56<br>ðŸ•’ 10:00â€“23:00</div>
        <div><strong>Bordeaux</strong><br>33 Rue du Chai des Farines, 33800 Bordeaux<br>ðŸ“ž +33 5 56 78 90 12<br>ðŸ•’ 10:00â€“23:00</div>
        <div><strong>Paris</strong><br>42 Rue de Rivoli, 75004 Paris<br>ðŸ“ž +33 1 45 67 89 01<br>ðŸ•’ 09:30â€“00:00</div>
        <div><strong>Toulouse</strong><br>18 Rue du Languedoc, 31000 Toulouse<br>ðŸ“ž +33 5 34 56 78 90<br>ðŸ•’ 10:00â€“23:00</div>
        <div><strong>Lille</strong><br>77 Rue Nationale, 59800 Lille<br>ðŸ“ž +33 3 20 12 34 56<br>ðŸ•’ 10:00â€“22:30</div>
        <div><strong>Charleroi (BE)</strong><br>26 Rue LÃ©on Bernus, 6000 Charleroi<br>ðŸ“ž +32 71 23 45 67<br>ðŸ•’ 10:00â€“22:00</div>
        <div><strong>LiÃ¨ge (BE)</strong><br>59 Quai de la Batte, 4020 LiÃ¨ge<br>ðŸ“ž +32 4 78 90 12 34<br>ðŸ•’ 10:00â€“23:00</div>
      </div>
      <p style="text-align: center; margin-top: 15px;">&copy; 2025 Cinephoria. All rights reserved.</p>
  </footer>

  <script>
      const API_URL = "http://127.0.0.1:5000/api/v1";
      document.getElementById("NewUserForm").addEventListener("submit", async (event) => {
      event.preventDefault();
      const form = event.target;
      try {
        const userData = {
          user_email: form.user_email.value,
          user_password: form.user_password.value,
          user_name: form.user_name.value,
          first_name: form.first_name.value,
          last_name: form.last_name.value,
          role_id: Number(form.role_id.value)
        };

        const response = await fetch(`${API_URL}/users`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(userData)
        });

        if (!response.ok) {
          throw new Error(`Error: ${response.statusText}`);
        }

        const result = await response.json();
        alert("User added successfully!");
        form.reset();
        window.location.href = "/users";

      } catch (err) {
        alert("Failed to add User: " + err.message);
      }

    });

</script>
</div>



</body>
</html>
